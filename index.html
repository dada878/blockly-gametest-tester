<!DOCTYPE html>
<html lang="zh_tw">
  <head>
      <!-- 定義Meta -->
      <meta charset="UTF-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">

      <!-- 引入Blockly套件 -->
      <script src="modules/blockly_compressed.js"></script>
      <script src="modules/blocks_compressed.js"></script>
      <script src="modules/javascript_compressed.js"></script>
      <script src="msg/js/zh-hant.js"></script>

      <!-- JsZip檔案處理套件 -->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js" integrity="sha512-xQBQYt9UcgblF6aCMrwU1NkVA7HCXaSN2oq0so80KO+y68M+n64FOcqgav4igHe6D5ObBLIf68DWv+gfBowczg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

      <!-- 自定義ToolBox -->
      <link rel="stylesheet" href="toolbox_style.css">
      <script src="custom_category.js"></script>
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

      <!-- 自定義方塊渲染器 -->
      <!-- <script src="custom_renderer.js"></script> -->

      <!-- 引入自製模組 -->
      <script type="module" src="blocks.js"></script> 
      <script src="lib.js"></script>

      <!-- 網站標題 -->
      <title>Gametest編輯器</title>

      <!-- 隱藏000webhost的Logo -->
      <style>img[alt="www.000webhost.com"]{display: none;}</style>

  </head>
  <body>
      <button onclick="check()">轉換程式碼</button>
      <button onclick="download_pack('hello',generate())">生成並下載模組</button>
      <button onclick="download_js(generate())">下載js檔案</button>
      <button onclick="upload_project()">匯入專案</button>
      <button onclick="download_project()">匯出專案</button>
      <div id="blocklyDiv" style="width: 1000px;height: 740px;"></div>

      <!-- 定義ToolBox內方塊 -->
      <xml xmlns="https://developers.google.com/blockly/xml" id="toolbox" style="display: none">
          <category name="邏輯判斷" colour="%{BKY_LOGIC_HUE}">
            <block type="controls_if"></block>
            <block type="logic_compare"></block>
            <block type="logic_operation"></block>
            <block type="logic_negate"></block>
            <block type="logic_boolean"></block>
          </category>
          <category name="流程控制" colour="%{BKY_LOOPS_HUE}">
            <block type="controls_repeat_ext">
              <value name="TIMES">
                <shadow type="math_number">
                  <field name="NUM">10</field>
                </shadow>
              </value>
            </block>

            <block type="lib_while"></block>

          </category>
          <category name="數學" colour="%{BKY_MATH_HUE}">
            <block type="math_number">
              <field name="NUM">123</field>
            </block>
            <block type="math_arithmetic">
              <value name="A">
                <shadow type="math_number">
                  <field name="NUM">1</field>
                </shadow>
              </value>
              <value name="B">
                <shadow type="math_number">
                  <field name="NUM">1</field>
                </shadow>
              </value>
            </block>
            <block type="math_single">
              <value name="NUM">
                <shadow type="math_number">
                  <field name="NUM">9</field>
                </shadow>
              </value>
            </block>
            <block type="math_trig">
              <value name="NUM">
                <shadow type="math_number">
                  <field name="NUM">45</field>
                </shadow>
              </value>
            </block>
            <block type="math_constant"></block>
            <block type="math_number_property">
              <value name="NUMBER_TO_CHECK">
                <shadow type="math_number">
                  <field name="NUM">0</field>
                </shadow>
              </value>
            </block>
            <block type="math_round">
              <value name="NUM">
                <shadow type="math_number">
                  <field name="NUM">3.1</field>
                </shadow>
              </value>
            </block>
            <block type="math_modulo">
              <value name="DIVIDEND">
                <shadow type="math_number">
                  <field name="NUM">64</field>
                </shadow>
              </value>
              <value name="DIVISOR">
                <shadow type="math_number">
                  <field name="NUM">10</field>
                </shadow>
              </value>
            </block>
            <block type="math_random_int">
              <value name="FROM">
                <shadow type="math_number">
                  <field name="NUM">1</field>
                </shadow>
              </value>
              <value name="TO">
                <shadow type="math_number">
                  <field name="NUM">100</field>
                </shadow>
              </value>
            </block>
          </category>
          <category name="文字" colour="%{BKY_TEXTS_HUE}">
            <block type="text"></block>
            <block type="text_join"></block>
            <block type="text_length">
              <value name="VALUE">
                <shadow type="text">
                  <field name="TEXT">abc</field>
                </shadow>
              </value>
            </block>

            <block type="get_substring"> 
              <value name="STRING">
                <shadow type="text">
                  <field name="TEXT">Hello</field>
                </shadow>
              </value>
              <value name="START">
                <shadow type="math_number">
                  <field name="NUM">2</field>
                </shadow>
              </value>
              <value name="END">
                <shadow type="math_number">
                  <field name="NUM">4</field>
                </shadow>
              </value>
            </block>

            <block type="lib_index_string"> 
              <value name="STRING">
                <shadow type="text">
                  <field name="TEXT">Hello</field>
                </shadow>
              </value>
              <value name="INDEX">
                <shadow type="math_number">
                  <field name="NUM">1</field>
                </shadow>
              </value>
            </block>
            
            <block type="is_str_in_str"> 
              <value name="STRING">
                <shadow type="text">
                  <field name="TEXT">ABCD</field>
                </shadow>
              </value>
              <value name="TARGET">
                <shadow type="text">
                  <field name="TEXT">C</field>
                </shadow>
              </value>
            </block>

            <!-- TODO:添加"檢查字串是否以某段文字開始"" -->

            <block type="text_changeCase">
              <value name="TEXT">
                <shadow type="text">
                  <field name="TEXT">abc</field>
                </shadow>
              </value>
            </block>
            <block type="text_trim">
              <value name="TEXT">
                <shadow type="text">
                  <field name="TEXT">abc</field>
                </shadow>
              </value>
            </block>
          </category>
          <category name="陣列" colour="%{BKY_LISTS_HUE}">
            <block type="lists_create_with">
              <mutation items="0"></mutation>
            </block>
            <block type="lists_create_with"></block>
            <block type="lists_length"></block>

            <!-- TODO:添加添加/取得/刪除/替換/尋找等方塊(參考Scratch) -->

          </category>
          <sep></sep>
          <category name="變數" colour="%{BKY_VARIABLES_HUE}" custom="VARIABLE"></category>
          <category name="函式" colour="%{BKY_PROCEDURES_HUE}" custom="PROCEDURE"></category>
          <sep></sep>
          <category name="遊戲控制" colour="50">
            <block type="gametest_run_command">
                <value name="COMMAND">
                    <block type="text">
                      <field name="TEXT">give @a apple</field>
                    </block>
                </value>
            </block>
            <block type="gametest_tellraw_command">
              <value name="MESSAGE">
                  <block type="text">
                    <field name="TEXT">hello</field>
                  </block>
              </value>
          </block>
            <block type="gametest_add_tag">
              <value name="PLAYER">
                  <block type="variables_get">
                    <field name="VAR">玩家</field>
                  </block>
              </value>
              <value name="TAG">
                <block type="text">
                  <field name="TEXT">Tag</field>
                </block>
            </value>
          </block>
          <block type="gametest_remove_tag">
            <value name="PLAYER">
                <block type="variables_get">
                  <field name="VAR">玩家</field>
                </block>
            </value>
            <value name="TAG">
              <block type="text">
                <field name="TEXT">Tag</field>
              </block>
          </value>
        </block>
            <block type="gametest_kill_player">
              <value name="PLAYER">
                <block type="variables_get">
                  <field name="VAR">玩家</field>
                </block>
              </value>
          </block>
        </category>
          <category name="監聽事件" colour="20">
              <block type="gametest_onchat">
                  <value name="PLAYER">
                      <block type="variables_get">
                        <field name="VAR">玩家</field>
                      </block>
                  </value>
                  <value name="MESSAGE">
                      <block type="variables_get">
                        <field name="VAR">訊息</field>
                      </block>
                  </value>
                  <value name="CANCEL">
                      <block type="logic_boolean">
                        <field name="BOOLEAN"></field>
                      </block>
                  </value>
              </block>
              <block type="gametest_onitemuse">
                <value name="PLAYER">
                    <block type="variables_get">
                      <field name="VAR">玩家</field>
                    </block>
                </value>
                <value name="ITEM">
                    <block type="variables_get">
                      <field name="VAR">物品</field>
                    </block>
                </value>
                <value name="CANCEL">
                    <block type="logic_boolean">
                      <field name="BOOLEAN"></field>
                    </block>
                </value>
            </block>
          </category>
          <category name="遊戲參數" colour="80">
            <label text="玩家類別"></label>
            <block type="gametest_getplayerpos">
                <value name="PLAYER">
                    <block type="variables_get">
                      <field name="VAR">玩家</field>
                    </block>
                </value>
            </block>
            <block type="gametest_getplayername">
                <value name="PLAYER">
                    <block type="variables_get">
                      <field name="VAR">玩家</field>
                    </block>
                </value>
            </block>
            <block type="gametest_getplayersneak">
              <value name="PLAYER">
                  <block type="variables_get">
                    <field name="VAR">玩家</field>
                  </block>
              </value>
          </block>
          <block type="gametest_has_tag">
            <value name="PLAYER">
                <block type="variables_get">
                  <field name="VAR">玩家</field>
                </block>
            </value>
            <value name="TAG">
              <block type="text">
                <field name="TEXT">Tag</field>
              </block>
          </value>
        </block>
            <label text="物品類別"></label>
            <block type="gametest_getitemid">
              <value name="ITEM">
                  <block type="variables_get">
                    <field name="VAR">物品</field>
                  </block>
              </value>
          </block>
          <block type="gametest_getitemamount">
            <value name="ITEM">
                <block type="variables_get">
                  <field name="VAR">物品</field>
                </block>
            </value>
        </block>
        <block type="gametest_getitemdata">
          <value name="ITEM">
              <block type="variables_get">
                <field name="VAR">物品</field>
              </block>
          </value>
      </block>
          <block type="gametest_getitemname">
            <value name="ITEM">
                <block type="variables_get">
                  <field name="VAR">物品</field>
                </block>
            </value>
        </block>
        </category>
        <category name="自訂UI" colour="180">
          <block type="gametest_gui_actionform" disabled="true">
              <value name="PLAYER">
                <field name="VAR">玩家</field>
              </value>
              <value name="SELECT">
                <field name="VAR">選項</field>
              </value>
          </block>
      </category>
      </xml>

      <!-- 引入模組 -->
      <script src="main.js"></script>
  </body>
</html>